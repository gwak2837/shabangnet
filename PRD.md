# 프로그램 개발 기획서

주문 취합 및 제조사별 발주 자동화 시스템

## 프로젝트 개요

- 프로젝트명: 사방넷 주문 데이터 기반 제조사별 발주서 자동 생성 및 발송 시스템
- 목표: 사방넷에서 취합된 통합 주문 엑셀 파일을 업로드하면, 제조사별로 자동 분류 및 양식 변환 후, 각 제조사 담당자에게 배송요청 이메일을 발송하는 업무의 자동화이며, 주문 데이터를 취합, 분류, 변환, 발송하는 과정을 효율적으로 수행하도록 설계되어야 함
- 사용자: 내부 정산/발주 담당자
- 환경: Windows PC 실행 프로그램 또는 웹 기반(Web Application)

## 업무 프로세스 (AS-IS vs TO-BE)

1. 현재 (AS-IS) - 수기 작업
   사방넷(쇼핑몰 주문 취합)에서 전체 주문내역 엑셀 다운로드.
   엑셀 필터를 이용해 제조사(공급사)별로 데이터를 분류.
   제조사 A의 엑셀 양식에 -> 주문 데이터를 복사/붙여넣기 및 가공(옵션명 수정 등).
   저장된 파일을 제조사 A 담당자에게 이메일 첨부 후 발송.
   위 과정을 수십 개 제조사 수만큼 반복 (오타 및 누락 발생 위험 높음).

2. 목표 (TO-BE) - 시스템화
   [입력] 사방넷에서 취합한 주문 엑셀 파일(Raw Data)을 시스템에 업로드.
   [처리] 상품코드/옵션명 기준으로 제조사 매칭 및 분류
   [처리] 제조사별 지정된 엑셀 양식(템플릿)에 데이터 매핑/변환 및 생성
   [검증] 변환된 결과물(제조사별 발주서 리스트)을 미리보기 및 확인.
   [출력] 제조사별 생성된 엑셀 파일을 첨부하여 제조사별 담당자 이메일로 자동 발송
   [출력] 발송결과 리포트(금일 발주 제조사 리스트, 발주 건수, 성공/오류 여부), 로그 저장

## 주요 기능 요구사항 (Functional Requirements)

기능은 사용자 인터페이스(UI)를 통해 쉽게 실행 가능하도록 설계.

1. 기초 데이터 관리 (Master Data Management)각
   - 제조사(공급사) 관리
     - 제조사명, 담당자 연락처/이메일 주소(수신참조 포함), 메일 제목/본문 템플릿 등록
     - 제조사별 사용하는 엑셀 양식(Template) 등록 (헤더 위치, 열 순서 등).
   - 상품-제조사 매칭 관리
     - 사방넷\_상품코드 vs 제조사명 매칭 테이블 관리.
     - 엑셀 일괄 업로드/다운로드 기능 필요 (상품 수가 많으므로).
   - 엑셀 양식 매핑 관리
     - Source: 사방넷 엑셀 컬럼 (예: 수취인명, 전화번호, 주소, 상품명, 수량 등)
     - Target: 제조사별 발주서 컬럼 (제조사마다 A열, B열의 입력내용이 다름)
     - 기능: 제조사별로 사방넷의 어떤 컬럼 값을 가져올지 설정할 수 있어야 함.
       (예: 사방넷의 '수취인명' -> 제조사 A열로 매핑 설정)
2. 주문 처리/변환 파일생성 (Process)
   - 주문서 업로드
     - 사방넷에서 다운로드한 엑셀 파일(.xlsx, .xls) 업로드 기능
     - 중복 업로드 방지 (주문번호 기준 중복 체크 등 선택 사항)
   - 자동 분류 및 변환 엔진
     - 업로드된 데이터의 제조사 정보를 기준으로 데이터를 그룹화.
     - 그룹화된 데이터를 각 제조사의 엑셀 양식에 맞춰 셀 채우기.
   - 데이터 검증
     - 등록되지 않은 상품코드(제조사 매칭불가 상품) 발견 시 [에러 리스트] 출력 및 알림 기능
   - 제조사별로 개별 엑셀 파일 생성 (UI에서 파일 리스트 확인 가능)
     - 파일명 규칙 설정 (예: [다온에프앤씨 발주서]\_제조사명\_YYYYMMDD.xlsx).
3. 결과 확인 및 발송 (Output)
   - 발주 대기 리스트
     - 변환이 완료된 건들을 제조사별로 리스트업.
     - 각 건별 생성된 엑셀 파일 다운로드/미리보기 기능.
   - 이메일 발송
     - 발송자 메일 계정(Gmail, Outlook, 회사 메일 등) SMTP 연동 설정.
     - 생성된 엑셀 파일을 첨부하여 제조사별 이메일로 발송.(선택 발송 및 일괄 발송 기능)
     - 메일 제목/본문 템플릿 설정 (예: 제목 [다온에프앤씨 발주서]\_제조사명\_YYYYMMDD). / 본문: 안녕하세요. (주)다온에프앤씨 발주 첨부파일 드립니다. 감사합니다.").
   - 발송 로그(Log)
     - 발송 이력 관리: 발송 성공/실패 여부, 언제, 누구에게, 어떤 파일을 보냈는지 로그 저장
     - 오류 건(예: 제조사 미매핑 상품, 필수 데이터 누락)은 별도 리스트에서 수정 후 재발송 가능
   - 중복 발주 방지
     - 동일 제조사 + 동일 수취인 배송주소로 설정 기간 내 발송 이력이 있을 경우 경고 표시
     - 중복 체크 기간 설정: 10일, 15일, 20일, 30일 중 선택 가능 (설정 화면에서 관리)
     - 중복 감지 시 강제 확인: 발송 사유 입력 필수 (예: "고객 요청으로 재발송")
     - 중복 발송 시 입력한 사유를 로그에 기록하여 추후 추적 가능

## 화면/메뉴 구성 예시 (UI/UX Concept)

- 대시보드
  - 오늘 업로드된 주문 파일 수
  - 오늘 생성된 발주 수, 이메일 발송 성공/실패 요약
- 주문 업로드 화면
  - 사방넷 주문 엑셀 파일 업로드
  - 업로드 결과(총 주문 수, 인식한 컬럼, 오류 유무 등) 표시
- 제조사 관리 화면
  - 제조사 목록 (검색, 추가, 수정, 삭제)
  - 제조사별 정보: 기본 정보, 이메일, 담당자, 엑셀 템플릿 설정 진입 버튼
- 상품 매핑 관리 화면
  - 사방넷 상품코드/상품명 리스트
  - 각 상품이 어느 제조사에 속하는지 지정
  - 미매핑 상품 필터링 기능
- 엑셀 템플릿 관리 화면
  - 제조사 선택 → 컬럼 리스트 편집
  - 각 컬럼에 대해: 컬럼명, 순서, 데이터 소스(주문데이터 필드/고정값/계산값)
- 발주 생성/발송 화면
  - 날짜/기간 선택
  - 발주 대상 주문 목록 조회
  - “발주 생성” 버튼 → 제조사별 발주 파일 생성
  - 생성된 파일 리스트 + “다운로드/이메일 발송” 버튼
- 로그/리포트 화면
  - 발주 이력, 이메일 발송 이력, 오류 내역 조회
- 설정 화면
  - SMTP 서버 설정 (이메일 발송용)
  - 중복 발주 체크 기간 설정 (10일/15일/20일/30일)

## 개발 참고 사항

- 확장성: 새로운 제조사가 추가되거나, 제조사의 엑셀 양식이 변경되었을 때 개발자 없이 사용자가 설정을 통해 매핑할 수 있는 기능(UI)이 가능해야 함.
- 데이터 처리: 하루 주문량이 수천 건이 될 수 있으므로, 엑셀 처리 속도가 너무 느리지 않도록 라이브러리 선정 필요
- 보안
  - 로그인/권한관리(운영자만 접근)
  - 개인정보(이름, 전화번호, 주소)등 민감 정보는 로컬에 저장 시 암호화 처리.
- 기타
  - 입력 파일 형식: 사방넷 주문취합 다운로드 양식 (샘플 파일 제공 예정).
  - 출력 파일 형식: 제조사별로 상이함 (대표적인 샘플 5종 제공 예정).
  - 플랫폼: 웹 기반(Web Application) 권장 (PC 설치 없이 브라우저 접속).

※ 개발자에게 전달해야 할 첨부 자료

- 사방넷 원본 엑셀 파일 (샘플): 개인정보는 가명 처리하되, 행/열 구조는 그대로 유지
- 제조사별 발주서 양식 (샘플):
  평범한 양식 2~3개, 가장 복잡한 양식 1개 (예: 셀 병합이 있거나, 수식이 걸려 있는 경우)
- 데이터 매핑 규칙 예시:
  (예) 사방넷 엑셀의 '수취인명' 열은 제조사 A 엑셀의 '고객명' 열에 들어가야 함.
  (예) 사방넷 상품명 '갈비'는 제조사 B 엑셀에서는 'K-001'로 변환되어야 함. 등
